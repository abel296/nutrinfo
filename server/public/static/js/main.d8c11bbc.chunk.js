(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{103:function(e,t,n){},104:function(e,t,n){},106:function(e,t,n){},107:function(e,t,n){},108:function(e,t,n){},113:function(e,t,n){},114:function(e,t,n){},115:function(e,t,n){},116:function(e,t,n){},117:function(e,t,n){},118:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),s=n(30),i=n.n(s),c=(n(73),n(8)),l=n(9),o=n(11),u=n(10),h=(n(74),n(6)),d=n(13),j=n(120),p=n(121),b=n(66),O=n(12),m=(n(75),n(1)),g=function(){return Object(m.jsx)(m.Fragment,{children:Object(m.jsx)("section",{className:"hero",children:Object(m.jsx)(j.a,{className:"d-flex align-items-center justify-content-center",children:Object(m.jsx)(p.a,{className:"justify-content-center align-items-center",children:Object(m.jsxs)(b.a,{children:[Object(m.jsx)("h1",{children:"Welcome to Nutrinfo"}),Object(m.jsx)("h5",{children:"Get all the info you need from your own recipes!"}),Object(m.jsx)(O.b,{className:"btn",to:"/signup",children:"Signup!"})]})})})})})},x=n(21),f=n.n(x),v=function e(){var t=this;Object(c.a)(this,e),this.createRecipe=function(e){return t.api.post("/createRecipe",e)},this.getRecipes=function(){return t.api.get("/getAllRecipes")},this.getRecipe=function(e){return t.api.get("/getOneRecipe/".concat(e))},this.getUserRecipes=function(e){return t.api.get("/getRecipesByUser/".concat(e))},this.deleteRecipe=function(e){return t.api.delete("/deleteRecipe/".concat(e))},this.editRecipe=function(e){return t.api.put("/editRecipe/".concat(e))},this.deleteRecipesByUser=function(e){return t.api.delete("/deleteRecipesByUser/".concat(e))},this.api=f.a.create({baseURL:"".concat("https://nutrinfoweb.herokuapp.com/api","/recipes"),withCredentials:!0})},y=n(128),C=(n(103),function(e){var t=e.image,n=e.title,r=e._id;return Object(m.jsx)(b.a,{className:"recipe-card",lg:4,md:6,xs:12,children:Object(m.jsxs)(y.a,{children:[Object(m.jsx)("div",{className:"card-image-wrapper",children:Object(m.jsx)(y.a.Img,{className:"card-image",variant:"top",src:null===t||void 0===t?void 0:t.url})}),Object(m.jsxs)(y.a.Body,{children:[Object(m.jsx)(y.a.Title,{children:n}),Object(m.jsx)(O.b,{to:"/recipe-details/".concat(r),className:"btn",children:"See details"})]})]})})}),S=function(e){var t=e.recipes;return Object(m.jsx)(p.a,{children:null===t||void 0===t?void 0:t.map((function(e){return Object(m.jsx)(C,Object(h.a)({},e),e._id)}))})},U=n(32),R=n(124),E=(n(104),function(e){Object(o.a)(n,e);var t=Object(u.a)(n);function n(){var e;return Object(c.a)(this,n),(e=t.call(this)).state={labelsSelected:[],ingredient:""},e.allLabelsArr=["ALCOHOL_FREE","CELERY_FREE","CRUSTACEAN_FREE","DAIRY_FREE","EGG_FREE","FISH_FREE","FODMAP_FREE","GLUTEN_FREE","KETO_FRIENDLY","KIDNEY_FRIENDLY","KOSHER","LOW_POTASIUM","LUPINE_FREE","MUSTARD_FREE","LOW_FAT_ABS","NO_OIL_ADDED","LOW_SUGAR","PALEO","PEANUT_FREE","PESCATARIAN","PORK_FREE","RED_MEAT_FREE","SESAME_FREE","SHELLFISH_FREE","SOY_FREE","SUGAR_CONSCIOUS","TREE_NUT_FREE","VEGAN","VEGETARIAN","WHEAT_FREE"],e}return Object(l.a)(n,[{key:"handleChange",value:function(e){var t=this;this.setState({ingredient:e.target.value},(function(){return t.props.filter(t.state)}))}},{key:"handleClick",value:function(e){var t=this,n=Object(U.a)(this.state.labelsSelected),r=e.target.value;if(n.includes(r)){var a=n.indexOf(r);n.splice(a,1)}else n.push(r);e.target.className?e.target.className="":e.target.className="active",this.setState({labelsSelected:n},(function(){return t.props.filter(t.state)}))}},{key:"render",value:function(){var e=this;return Object(m.jsx)(m.Fragment,{children:Object(m.jsxs)(j.a,{className:"labels-section",children:[Object(m.jsx)("h2",{children:"Filters"}),Object(m.jsxs)(p.a,{className:"labels",children:[Object(m.jsx)(R.a.Group,{className:"ing-filter",children:Object(m.jsx)(R.a.Control,{size:"sm",type:"text",placeholder:"Search ingredient",value:this.state.ingredient,onChange:function(t){return e.handleChange(t)}})}),this.allLabelsArr.map((function(t,n){return Object(m.jsx)(b.a,{className:"label",md:12,sm:4,xs:6,children:Object(m.jsx)("input",{type:"button",value:t,onClick:function(t){return e.handleClick(t)}})},n)}))]})]})})}}]),n}(r.Component)),N=(n(106),function(){return Object(m.jsx)("div",{className:"spinner"})}),w=n.p+"static/media/magnifying-glass.23b6707c.png",k=(n(107),function(e){Object(o.a)(n,e);var t=Object(u.a)(n);function n(){var e;return Object(c.a)(this,n),(e=t.call(this)).state={recipes:void 0},e.recipeService=new v,e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.loadRecipes()}},{key:"loadRecipes",value:function(){var e=this;this.recipeService.getRecipes().then((function(t){return e.setState({recipes:t.data})})).catch((function(){return e.props.handleAlert(!0,"Error","Error loading recipes")}))}},{key:"filterRecipes",value:function(e){var t=this,n=e.labelsSelected,r=e.ingredient.toLowerCase();this.recipeService.getRecipes().then((function(e){var a=e.data.filter((function(e){return n.every((function(t){var n;return null===(n=e.labels)||void 0===n?void 0:n.includes(t)}))&&e.ingredients.some((function(e){return e.name.toLowerCase().includes(r)}))}));t.setState({recipes:a})})).catch((function(){return t.props.handleAlert(!0,"Error","Error filtering recipes")}))}},{key:"render",value:function(){var e=this;return Object(m.jsx)(m.Fragment,{children:this.state.recipes?Object(m.jsx)(m.Fragment,{children:Object(m.jsxs)(p.a,{className:"recipes-section",children:[Object(m.jsx)(b.a,{lg:2,md:3,xs:12,children:Object(m.jsx)(E,{filter:function(t){return e.filterRecipes(t)}})}),this.state.recipes[0]?Object(m.jsx)(b.a,{lg:10,md:9,xs:12,children:Object(m.jsxs)(j.a,{children:[Object(m.jsx)("h1",{children:"Recipes"}),Object(m.jsx)(S,{recipes:this.state.recipes})]})}):Object(m.jsx)(j.a,{children:Object(m.jsx)(p.a,{className:"justify-content-center",children:Object(m.jsxs)(b.a,{md:7,children:[Object(m.jsx)("h5",{children:"The filters you applied doesn't match with any recipe"}),Object(m.jsx)("img",{className:"glass-img",src:w,alt:"Magnifying glass logo"})]})})})]})}):Object(m.jsx)(m.Fragment,{children:Object(m.jsx)("div",{className:"spinner-div",children:Object(m.jsx)(N,{})})})})}}]),n}(r.Component)),A=(n(108),function(e){var t=e.recipeComments;return Object(m.jsx)(p.a,{children:t.map((function(e){return Object(m.jsxs)(b.a,{className:"comment",xl:12,children:[Object(m.jsxs)("div",{children:[Object(m.jsx)("img",{src:e.owner.image.url,alt:e.owner.image.alt}),Object(m.jsx)("h6",{children:e.owner.username})]}),Object(m.jsx)("p",{children:e.text}),Object(m.jsx)("hr",{})]},e._id)}))})}),F=n(57),L=n.n(F),I=function(e){Object(o.a)(n,e);var t=Object(u.a)(n);function n(){var e;return Object(c.a)(this,n),(e=t.call(this)).chartRef=a.a.createRef(),e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=this.props.data.map((function(e){return e.label})).splice(1),t=this.props.data.map((function(e){return e.quantity})).splice(1);this.myChart=new L.a(this.chartRef.current,{type:"doughnut",data:{labels:e,datasets:[{data:t,backgroundColor:["#EF476F","#FFD166","#06D6A0"]}]}});var n=this.props;L.a.pluginService.register({beforeDraw:function(e){var t=e.chart.width,r=e.chart.height,a=e.chart.ctx;a.clearRect(0,0,t,r),a.restore();var s=(r/150).toFixed(2);a.font=s+"em sans-serif",a.textBaseline="middle";var i=Math.round(n.data[0].quantity),c=Math.round((t-a.measureText(i).width)/2),l=r/2;a.fillText(i,c,l);var o=(r/200).toFixed(2);a.font=o+"em sans-serif",a.textBaseline="middle";var u=n.data[0].unit,h=Math.round((t-a.measureText(i).width)/2+5),d=r/2+30;a.fillText(u,h,d),a.save()}})}},{key:"render",value:function(){var e=this.props.data.map((function(e){return e})).splice(1);return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("canvas",{ref:this.chartRef}),Object(m.jsx)(p.a,{className:"justify-content-around nutrients-row",children:e.map((function(e,t){return Object(m.jsx)(b.a,{sm:4,children:Object(m.jsxs)("p",{className:"nutrients-data",children:[Object(m.jsx)("strong",{children:e.label}),": ",e.quantity.toFixed(2)," ",e.unit]})},t)}))})]})}}]),n}(r.Component),_=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},T=function(e){var t=e.image,n=e.ingredients,r=e.labels,a=e.nutrients,s=e.servings;return Object(m.jsxs)(p.a,{children:[Object(m.jsxs)(b.a,{lg:6,children:[t&&Object(m.jsx)("img",{className:"recipe-img",src:t.url,alt:t.alt}),Object(m.jsx)("h5",{children:"Ingredients"}),Object(m.jsx)("ul",{children:n.map((function(e){return Object(m.jsxs)("li",{children:[Object(m.jsx)("strong",{children:_(e.name)}),": ",e.quantity," ",e.unit]},e._id)}))}),Object(m.jsxs)("p",{className:"servings",children:[Object(m.jsx)("strong",{children:"Servings:"})," ",s]})]}),Object(m.jsxs)(b.a,{lg:6,children:[Object(m.jsx)("h4",{children:"Nutrients"}),Object(m.jsx)(I,{title:"Nutrients",data:a}),Object(m.jsx)(p.a,{children:r&&r.map((function(e,t){return Object(m.jsx)(b.a,{md:4,xs:6,children:Object(m.jsx)("p",{className:"health-labels",children:_(e)})},t)}))})]})]})},D=function(e){var t=e%10,n=e%100;return 1===t&&11!==n?e+"st":2===t&&12!==n?e+"nd":3===t&&13!==n?e+"rd":e+"th"},P=function(e){var t=e.steps,n=e.time;return Object(m.jsx)(p.a,{children:Object(m.jsxs)(b.a,{children:[Object(m.jsx)("h5",{children:"Steps"}),Object(m.jsx)("ul",{children:t.map((function(e){return Object(m.jsxs)("li",{children:[Object(m.jsx)("strong",{children:D(e.number)})," ",_(e.step)]},e._id)}))}),Object(m.jsxs)("p",{className:"time",children:[Object(m.jsx)("strong",{children:"Time:"})," ",n," min"]})]})})},q=n(68),B=n.n(q),G=function e(){var t=this;Object(c.a)(this,e),this.getRatings=function(e){return t.api.get("/getRecipeRatings/".concat(e))},this.createRating=function(e,n){return t.api.post("/createRating/".concat(e),n)},this.deleteRatingsByUser=function(e){return t.api.delete("/deleteRatingsByUser/".concat(e))},this.api=f.a.create({baseURL:"".concat("https://nutrinfoweb.herokuapp.com/api","/ratings"),withCredentials:!0})},M=function(e){Object(o.a)(n,e);var t=Object(u.a)(n);function n(){var e;return Object(c.a)(this,n),(e=t.call(this)).state={rating:0},e.ratingsService=new G,e}return Object(l.a)(n,[{key:"handleInputChange",value:function(e){var t=this;this.setState({rating:e},(function(){return t.createRating()}))}},{key:"createRating",value:function(){var e=this;this.ratingsService.createRating(this.props.param,this.state).then((function(t){t.data.message&&e.props.handleAlert(!0,"Error",t.data.message),e.props.refreshList()})).catch((function(){return e.props.handleAlert(!0,"Error","Error creating rating")}))}},{key:"render",value:function(){var e=this;return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(B.a,{size:30,isHalf:!0,onChange:function(t){return e.handleInputChange(t)}}),"NaN"===this.props.recipeRating?Object(m.jsx)("p",{}):Object(m.jsx)("h6",{children:this.props.recipeRating})]})}}]),n}(r.Component),H=n(18),K=n(122),Y=function e(){var t=this;Object(c.a)(this,e),this.getComments=function(e){return t.api.get("/getRecipeComments/".concat(e))},this.createComment=function(e,n){return t.api.post("/createComment/".concat(e),n)},this.deleteCommentsByUser=function(e){return t.api.delete("/deleteCommentsByUser/".concat(e))},this.api=f.a.create({baseURL:"".concat("https://nutrinfoweb.herokuapp.com/api","/comments"),withCredentials:!0})},W=function(e){Object(o.a)(n,e);var t=Object(u.a)(n);function n(){var e;return Object(c.a)(this,n),(e=t.call(this)).state={text:""},e.commentsService=new Y,e}return Object(l.a)(n,[{key:"handleInputChange",value:function(e){var t=e.target,n=t.name,r=t.value;this.setState(Object(H.a)({},n,r))}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),this.commentsService.createComment(this.props.param,this.state).then((function(){t.setState({text:""},(function(){return t.props.refreshList()}))})).catch((function(){return t.props.handleAlert(!0,"Error","Error creating comment")}))}},{key:"render",value:function(){var e=this;return Object(m.jsxs)(R.a,{onSubmit:function(t){return e.handleSubmit(t)},children:[Object(m.jsxs)(R.a.Group,{controlId:"commentTextArea",children:[Object(m.jsx)(R.a.Label,{children:"Comment"}),Object(m.jsx)(R.a.Control,{as:"textarea",rows:3,type:"text",name:"text",value:this.state.text,onChange:function(t){return e.handleInputChange(t)}})]}),Object(m.jsx)(K.a,{type:"submit",children:"Submit"})]})}}]),n}(r.Component),z=function(e){Object(o.a)(n,e);var t=Object(u.a)(n);function n(){var e;return Object(c.a)(this,n),(e=t.call(this)).state={recipe:void 0,recipeComments:[],recipeRating:0},e.recipeService=new v,e.commentsService=new Y,e.ratingsService=new G,e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.loadRecipe()}},{key:"loadRecipe",value:function(){var e=this,t=this.props.match.params.recipe_id,n=this.recipeService.getRecipe(t),r=this.commentsService.getComments(t),a=this.ratingsService.getRatings(t);Promise.all([n,r,a]).then((function(t){if(t[0].data.message)e.props.handleAlert(!0,"Error",t[0].data.message),e.props.history.push("/recipes");else{var n,r,a,s,i=((null===(n=t[2])||void 0===n?void 0:n.data.reduce((function(e,t){return e+t.rating}),0))/(null===(r=t[2])||void 0===r?void 0:r.data.length)).toFixed(2);e.setState({recipe:null===(a=t[0])||void 0===a?void 0:a.data,recipeComments:null===(s=t[1])||void 0===s?void 0:s.data,recipeRating:i})}})).catch((function(){return e.props.handleAlert(!0,"Error","Error getting recipe details")}))}},{key:"render",value:function(){var e=this;return Object(m.jsx)(j.a,{as:"section",children:this.state.recipe?Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("h2",{children:_(this.state.recipe.title)}),Object(m.jsxs)("p",{children:[Object(m.jsx)("strong",{children:"User:"})," ",this.state.recipe.owner.username]}),Object(m.jsx)(T,Object(h.a)({},this.state.recipe)),Object(m.jsx)("hr",{}),Object(m.jsx)(P,Object(h.a)({},this.state.recipe)),this.props.loggedUser&&Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(M,{param:this.props.match.params.recipe_id,recipeRating:this.state.recipeRating,handleAlert:this.props.handleAlert,refreshList:function(){return e.loadRecipe()}}),Object(m.jsx)(W,{handleAlert:this.props.handleAlert,param:this.props.match.params.recipe_id,refreshList:function(){return e.loadRecipe()}})]}),Object(m.jsx)(A,{recipeComments:this.state.recipeComments}),Object(m.jsx)(O.b,{to:"/recipes",className:"btn go-back",children:"Go back"})]}):Object(m.jsx)(m.Fragment,{children:Object(m.jsx)("div",{className:"spinner-div",children:Object(m.jsx)(N,{})})})})}}]),n}(r.Component),J=function e(){var t=this;Object(c.a)(this,e),this.getIngredientInfo=function(e,n,r){return t.api.get("/nutrition-data?app_id=9fcb4124&app_key=a90360aec028b68517fa17842976b5ee&ingr=".concat(n,"%20").concat(r,"%20").concat(e))},this.api=f.a.create({baseURL:"https://api.edamam.com/api"})},V=function e(){var t=this;Object(c.a)(this,e),this.uploadFile=function(e){return t.api.post("/upload",e)},this.api=f.a.create({baseURL:"".concat("https://nutrinfoweb.herokuapp.com/api","/files"),withCredentials:!0})},Q=n(129),X=(n(113),n.p+"static/media/close.54e3dd7b.svg"),Z=function(e){Object(o.a)(n,e);var t=Object(u.a)(n);function n(){var e;return Object(c.a)(this,n),(e=t.call(this)).handleFileUpload=function(t){e.setState({isUploading:!0});var n=new FormData;n.append("imageUrl",t.target.files[0]),e.uploadService.uploadFile(n).then((function(t){e.setState({isUploading:!1,recipe:Object(h.a)(Object(h.a)({},e.state.recipe),{},{image:{url:t.data.secure_url,alt:e.state.recipe.title}})})})).catch((function(){return e.props.handleAlert(!0,"Error","Error uploading image")}))},e.state={recipe:{image:{url:"https://masquevinilo.com/5324-thickbox_default/vinilo-decorativo-verduras-a-la-sarten.jpg",alt:"frying pan with vegetables"},title:"",ingredients:[],nutrients:[],steps:[],time:0,servings:0,labels:[]},ingToPush:{name:"",quantity:0,unit:""},stepToPush:{step:"",number:0},isUploading:!1},e.recipeService=new v,e.edamamService=new J,e.uploadService=new V,e}return Object(l.a)(n,[{key:"handleInputChange",value:function(e){var t=e.target,n=t.name,r=t.value;this.setState({recipe:Object(h.a)(Object(h.a)({},this.state.recipe),{},Object(H.a)({},n,r))})}},{key:"handleIngredientInputChange",value:function(e){var t=e.target,n=t.name,r=t.value;this.setState({ingToPush:Object(h.a)(Object(h.a)({},this.state.ingToPush),{},Object(H.a)({},n,r))})}},{key:"addIngredient",value:function(){this.setState({recipe:Object(h.a)(Object(h.a)({},this.state.recipe),{},{ingredients:[].concat(Object(U.a)(this.state.recipe.ingredients),[this.state.ingToPush])})})}},{key:"handleStepInputChange",value:function(e){var t=e.target,n=t.name,r=t.value;this.setState({stepToPush:Object(h.a)(Object(h.a)({},this.state.stepToPush),{},Object(H.a)({},n,r))})}},{key:"addStep",value:function(){this.setState({recipe:Object(h.a)(Object(h.a)({},this.state.recipe),{},{steps:[].concat(Object(U.a)(this.state.recipe.steps),[this.state.stepToPush])})})}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault();var n=this.state.recipe.ingredients.map((function(e){return t.edamamService.getIngredientInfo(e.name,e.quantity,e.unit).then((function(e){return e.data}))}));Promise.all(n).then((function(e){if(e.some((function(e){return!e.totalNutrients.ENERC_KCAL})))return!1;var n=e.reduce((function(e,t){return e[0].quantity+=t.totalNutrients.ENERC_KCAL.quantity,e[1].quantity+=t.totalNutrients.FAT.quantity,e[2].quantity+=t.totalNutrients.CHOCDF.quantity,e[3].quantity+=t.totalNutrients.PROCNT.quantity,e}),[{label:"Energy",quantity:0,unit:"kcal"},{label:"Fat",quantity:0,unit:"g"},{label:"Carbs",quantity:0,unit:"g"},{label:"Protein",quantity:0,unit:"g"}]),r=e.reduce((function(e,t,n){var r=[];return e.forEach((function(e){t.healthLabels.includes(e)&&r.push(e)})),r}),e[0].healthLabels);return t.setState({recipe:Object(h.a)(Object(h.a)({},t.state.recipe),{},{nutrients:n,labels:r})}),!0})).then((function(e){if(e){var n=t.props.loggedUser._id;return t.recipeService.createRecipe(Object(h.a)(Object(h.a)({},t.state.recipe),{},{owner:n}))}return!1})).then((function(e){e?(t.props.closeModal(),t.props.refreshList(),t.props.handleAlert(!0,"Registration saved","The recipe has been saved into our Database")):t.props.handleAlert(!0,"Error","Some of the ingredients doesn't exist or some of the quantities are 0")})).catch((function(){return t.props.handleAlert(!0,"Error","Error creating recipe")}))}},{key:"deleteIngredient",value:function(e){var t=Object(U.a)(this.state.recipe.ingredients);t.splice(e,1),this.setState({recipe:Object(h.a)(Object(h.a)({},this.state.recipe),{},{ingredients:t})})}},{key:"deleteStep",value:function(e){var t=Object(U.a)(this.state.recipe.steps);t.splice(e,1),this.setState({recipe:Object(h.a)(Object(h.a)({},this.state.recipe),{},{steps:t})})}},{key:"render",value:function(){var e,t,n=this;return Object(m.jsx)(j.a,{children:Object(m.jsxs)(R.a,{onSubmit:function(e){return n.handleSubmit(e)},children:[Object(m.jsxs)(R.a.Group,{children:[Object(m.jsx)(R.a.Label,{children:"Title"}),Object(m.jsx)(R.a.Control,{type:"text",name:"title",value:this.state.recipe.title,onChange:function(e){return n.handleInputChange(e)}})]}),Object(m.jsxs)(R.a.Group,{children:[Object(m.jsxs)(p.a,{children:[Object(m.jsxs)(b.a,{md:{span:5},children:[Object(m.jsx)(R.a.Label,{children:"Ingredient"}),Object(m.jsx)(R.a.Control,{type:"text",name:"name",value:this.state.ingToPush.name,onChange:function(e){return n.handleIngredientInputChange(e)}})]}),Object(m.jsxs)(b.a,{md:{span:2},children:[Object(m.jsx)(R.a.Label,{children:"Quantity"}),Object(m.jsx)(R.a.Control,{type:"number",name:"quantity",value:this.state.ingToPush.quantity,onChange:function(e){return n.handleIngredientInputChange(e)}})]}),Object(m.jsxs)(b.a,{md:{span:2},children:[Object(m.jsx)(R.a.Label,{children:"Unit"}),Object(m.jsxs)(R.a.Control,{as:"select",className:"mr-sm-2",id:"inlineFormCustomSelect",name:"unit",custom:!0,onChange:function(e){return n.handleIngredientInputChange(e)},children:[Object(m.jsx)("option",{value:"",children:"Choose..."}),Object(m.jsx)("option",{value:"g",children:"g"}),Object(m.jsx)("option",{value:"Kg",children:"kg"}),Object(m.jsx)("option",{value:"l",children:"l"}),Object(m.jsx)("option",{value:"ml",children:"ml"})]})]}),Object(m.jsx)(b.a,{className:"add-ing-btn",md:{span:3},children:Object(m.jsx)(K.a,{onClick:function(){return n.addIngredient()},type:"button",children:"Add ingredient"})})]}),Object(m.jsx)(b.a,{className:"item-col",children:Object(m.jsx)(Q.a,{variant:"flush",children:null===(e=this.state.recipe.ingredients)||void 0===e?void 0:e.map((function(e,t){return Object(m.jsx)(m.Fragment,{children:Object(m.jsxs)(Q.a.Item,{className:"item-list",children:[e.name," ",e.quantity,e.unit,Object(m.jsx)(K.a,{className:"delete-button",onClick:function(){return n.deleteIngredient(t)},children:Object(m.jsx)("img",{src:X,alt:"x icon"})})]},t)})}))})})]}),Object(m.jsxs)(R.a.Group,{children:[Object(m.jsxs)(p.a,{children:[Object(m.jsxs)(b.a,{md:{span:2},children:[Object(m.jsx)(R.a.Label,{children:"Number"}),Object(m.jsx)(R.a.Control,{type:"number",name:"number",value:this.state.stepToPush.number,onChange:function(e){return n.handleStepInputChange(e)}})]}),Object(m.jsxs)(b.a,{children:[Object(m.jsx)(R.a.Label,{children:"Step"}),Object(m.jsx)(R.a.Control,{type:"text",name:"step",value:this.state.stepToPush.step,onChange:function(e){return n.handleStepInputChange(e)}})]}),Object(m.jsx)(b.a,{className:"add-step-btn",md:{span:3},children:Object(m.jsx)(K.a,{onClick:function(){return n.addStep()},type:"button",children:"Add step"})})]}),Object(m.jsx)(b.a,{className:"item-col",children:Object(m.jsx)(Q.a,{variant:"flush",children:null===(t=this.state.recipe.steps)||void 0===t?void 0:t.map((function(e,t){return Object(m.jsxs)(Q.a.Item,{className:"item-list",children:[e.number," ",e.step,Object(m.jsx)(K.a,{className:"delete-button",onClick:function(){return n.deleteStep(t)},children:Object(m.jsx)("img",{src:X,alt:"x icon"})})]},t)}))})})]}),Object(m.jsx)(R.a.Group,{children:Object(m.jsxs)(p.a,{children:[Object(m.jsxs)(b.a,{children:[Object(m.jsx)(R.a.Label,{children:"Time"}),Object(m.jsx)(R.a.Control,{type:"number",name:"time",value:this.state.recipe.time,onChange:function(e){return n.handleInputChange(e)}})]}),Object(m.jsxs)(b.a,{children:[Object(m.jsx)(R.a.Label,{children:"Servings"}),Object(m.jsx)(R.a.Control,{type:"number",name:"servings",value:this.state.recipe.servings,onChange:function(e){return n.handleInputChange(e)}})]})]})}),Object(m.jsxs)(R.a.Group,{children:[Object(m.jsxs)(R.a.Label,{children:["Image (File) ",this.state.isUploading&&Object(m.jsx)(N,{})]}),Object(m.jsx)(R.a.Control,{type:"file",name:"imageUrl",onChange:function(e){return n.handleFileUpload(e)}})]}),Object(m.jsx)(K.a,{block:!0,type:"submit",disabled:this.state.isUploading,children:this.state.isUploading?"Waiting, uploading...":"New Recipe"})]})})}}]),n}(r.Component),$=(n(114),function(e){var t=e.image,n=e.title,r=e._id,a=e.refreshList,s=e.handleAlert,i=new v;return Object(m.jsx)(b.a,{lg:4,md:6,xs:12,children:Object(m.jsxs)(y.a,{className:"user-card",children:[Object(m.jsx)("div",{className:"card-image-wrapper",children:Object(m.jsx)(y.a.Img,{className:"card-image",variant:"top",src:null===t||void 0===t?void 0:t.url})}),Object(m.jsxs)(y.a.Body,{children:[Object(m.jsx)(y.a.Title,{children:n}),Object(m.jsxs)("div",{className:"profile-btn",children:[Object(m.jsx)(O.b,{to:"/recipe-details/".concat(r),className:"btn profile-details-btn",children:"See details"}),Object(m.jsx)(K.a,{onClick:function(){i.deleteRecipe(r).then((function(){return a()})).catch((function(e){return s(!0,"Error","Error removing recipe")}))},className:"profile-details-btn delete-btn",children:"Delete Recipe"})]})]})]})})}),ee=function(e){var t=e.userRecipes,n=e.refreshList,r=e.handleAlert;return Object(m.jsx)(p.a,{children:null===t||void 0===t?void 0:t.map((function(e){return Object(m.jsx)($,Object(h.a)(Object(h.a)({handleAlert:r},e),{},{refreshList:n}),e._id)}))})},te=n(123),ne=(n(115),function e(){var t=this;Object(c.a)(this,e),this.signup=function(e){return t.api.post("/signup",e)},this.login=function(e){return t.api.post("/login",e)},this.editUser=function(e,n){return t.api.put("/edit/".concat(e),n)},this.isLoggedIn=function(){return t.api.get("/loggedin")},this.logOut=function(){return t.api.post("/logout")},this.deleteUser=function(e){return t.api.delete("/delete/".concat(e))},this.api=f.a.create({baseURL:"".concat("https://nutrinfoweb.herokuapp.com/api","/auth"),withCredentials:!0})}),re=function(e){Object(o.a)(n,e);var t=Object(u.a)(n);function n(){var e;return Object(c.a)(this,n),(e=t.call(this)).state={userRecipes:[],showForm:!1,showDelete:!1},e.recipeService=new v,e.authService=new ne,e.commentsService=new Y,e.ratingsService=new G,e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.loadUserRecipes()}},{key:"loadUserRecipes",value:function(){var e=this;this.recipeService.getUserRecipes(this.props.loggedUser._id).then((function(t){return e.setState({userRecipes:t.data})})).catch((function(t){return e.props.handleAlert(!0,"Error","Error loading recipes")}))}},{key:"togglemodalForm",value:function(e){this.setState({showForm:e})}},{key:"deleteAccount",value:function(){var e=this,t=this.authService.deleteUser(this.props.loggedUser._id),n=this.commentsService.deleteCommentsByUser(this.props.loggedUser._id),r=this.ratingsService.deleteRatingsByUser(this.props.loggedUser._id),a=this.recipeService.deleteRecipesByUser(this.props.loggedUser._id);Promise.all([t,n,r,a]).then((function(t){e.props.handleAlert(!0,"Alert",t[0].data.message),e.props.history.push("/"),e.props.refreshUser()})).catch((function(){return e.props.handleAlert(!0,"Error","Error removing user")}))}},{key:"togglemodalDelete",value:function(e){this.setState({showDelete:e})}},{key:"render",value:function(){var e=this;return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsxs)(p.a,{className:"justify-content-center user-recipes",children:[Object(m.jsx)(b.a,{lg:2,md:3,xs:4,className:"avatar-section ",children:Object(m.jsx)(j.a,{children:Object(m.jsx)(p.a,{className:"avatar-row justify-content-center",children:Object(m.jsxs)("header",{className:"header",children:[Object(m.jsx)("img",{className:"profile-img",src:this.props.loggedUser.image.url,alt:this.props.loggedUser.image.alt}),Object(m.jsxs)("h1",{children:["Hi, ",this.props.loggedUser.username,"! "]}),Object(m.jsx)(O.b,{to:"edit-user/".concat(this.props.loggedUser._id),className:"btn edit-recipe-btn",children:"Edit Profile"})]})})})}),Object(m.jsx)(b.a,{lg:12,md:12,xs:12,children:Object(m.jsxs)(j.a,{children:[Object(m.jsx)("h1",{children:"My recipes"}),Object(m.jsx)("div",{children:Object(m.jsx)(K.a,{onClick:function(){return e.togglemodalForm(!0)},className:"new-recipe-btn",children:"New Recipe"})}),Object(m.jsx)(ee,{handleAlert:this.props.handleAlert,userRecipes:this.state.userRecipes,refreshList:function(){return e.loadUserRecipes()}})]})}),Object(m.jsx)(K.a,{onClick:function(){return e.togglemodalDelete(!0)},className:"btn delete-btn delete-user-btn",children:"Delete User"})]}),Object(m.jsxs)(te.a,{show:this.state.showForm,onHide:function(){return e.togglemodalForm(!1)},children:[Object(m.jsx)(te.a.Header,{closeButton:!0,children:Object(m.jsx)(te.a.Title,{children:"New recipe"})}),Object(m.jsx)(te.a.Body,{children:Object(m.jsx)(Z,{loggedUser:this.props.loggedUser,closeModal:function(){return e.togglemodalForm(!1)},refreshList:function(){return e.loadUserRecipes()},handleAlert:this.props.handleAlert})})]}),Object(m.jsxs)(te.a,{show:this.state.showDelete,onHide:function(){return e.togglemodalDelete(!1)},children:[Object(m.jsx)(te.a.Header,{closeButton:!0,children:Object(m.jsx)(te.a.Title,{children:"Are you sure?"})}),Object(m.jsx)(te.a.Body,{children:Object(m.jsx)(K.a,{className:"btn delete-btn",onClick:function(){return e.deleteAccount()},children:"Delete Account"})})]})]})}}]),n}(r.Component),ae=function(e){Object(o.a)(n,e);var t=Object(u.a)(n);function n(){var e;return Object(c.a)(this,n),(e=t.call(this)).state={username:"",password:""},e.authService=new ne,e}return Object(l.a)(n,[{key:"handleInputChange",value:function(e){var t=e.target,n=t.name,r=t.value;this.setState(Object(H.a)({},n,r))}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),this.authService.signup(this.state).then((function(e){t.props.storeUser(e.data),t.props.history.push("/")})).catch((function(e){return t.props.handleAlert(!0,"Error",e.response.data.message)}))}},{key:"render",value:function(){var e=this;return Object(m.jsx)(j.a,{children:Object(m.jsx)(p.a,{children:Object(m.jsxs)(b.a,{md:{span:4,offset:4},children:[Object(m.jsx)("h1",{children:"Signup"}),Object(m.jsx)("hr",{}),Object(m.jsxs)(R.a,{onSubmit:function(t){return e.handleSubmit(t)},children:[Object(m.jsxs)(R.a.Group,{children:[Object(m.jsx)(R.a.Label,{children:"Username"}),Object(m.jsx)(R.a.Control,{type:"text",name:"username",value:this.state.username,onChange:function(t){return e.handleInputChange(t)}}),Object(m.jsxs)(R.a.Text,{className:"text-muted",children:["Do you already have an account?  ",Object(m.jsx)(O.b,{to:"/login",children:"Log In here!"})]})]}),Object(m.jsxs)(R.a.Group,{children:[Object(m.jsx)(R.a.Label,{children:"Password"}),Object(m.jsx)(R.a.Control,{type:"password",name:"password",value:this.state.password,onChange:function(t){return e.handleInputChange(t)}})]}),Object(m.jsx)(K.a,{block:!0,type:"submit",children:"Submit"})]})]})})})}}]),n}(r.Component),se=function(e){Object(o.a)(n,e);var t=Object(u.a)(n);function n(){var e;return Object(c.a)(this,n),(e=t.call(this)).state={username:"",password:""},e.authService=new ne,e}return Object(l.a)(n,[{key:"handleInputChange",value:function(e){var t=e.target,n=t.name,r=t.value;this.setState(Object(H.a)({},n,r))}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),this.authService.login(this.state).then((function(e){t.props.storeUser(e.data),t.props.history.push("/")})).catch((function(e){return t.props.handleAlert(!0,"Error",e.response.data.message)}))}},{key:"render",value:function(){var e=this;return Object(m.jsx)(j.a,{children:Object(m.jsx)(p.a,{children:Object(m.jsxs)(b.a,{md:{span:4,offset:4},children:[Object(m.jsx)("h1",{children:"Login"}),Object(m.jsx)("hr",{}),Object(m.jsxs)(R.a,{onSubmit:function(t){return e.handleSubmit(t)},children:[Object(m.jsxs)(R.a.Group,{children:[Object(m.jsx)(R.a.Label,{children:"Username"}),Object(m.jsx)(R.a.Control,{type:"text",name:"username",value:this.state.username,onChange:function(t){return e.handleInputChange(t)}}),Object(m.jsxs)(R.a.Text,{className:"text-muted",children:["Don't you have an account? ",Object(m.jsx)(O.b,{to:"/login",children:"Signup here!"})]})]}),Object(m.jsxs)(R.a.Group,{children:[Object(m.jsx)(R.a.Label,{children:"Password"}),Object(m.jsx)(R.a.Control,{type:"password",name:"password",value:this.state.password,onChange:function(t){return e.handleInputChange(t)}})]}),Object(m.jsx)(K.a,{block:!0,type:"submit",children:"Submit"})]})]})})})}}]),n}(r.Component),ie=function(e){Object(o.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this,e)).state={user:{username:r.props.loggedUser.username,password:"",image:""},isUploading:!1},r.authService=new ne,r.uploadService=new V,r}return Object(l.a)(n,[{key:"handleInputChange",value:function(e){var t=e.target,n=t.name,r=t.value;this.setState({user:Object(h.a)(Object(h.a)({},this.state.user),{},Object(H.a)({},n,r))})}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),this.authService.editUser(this.props.match.params.user_id,this.state.user).then((function(){var e=t.state.user,n=e.username,r=e.password;return t.authService.login({username:n,password:r})})).then((function(){t.props.refreshUser(),t.props.history.push("/profile")})).catch((function(){return t.props.handleAlert(!0,"Error","Error editing user")}))}},{key:"handleFileUpload",value:function(e){var t=this;this.setState({isUploading:!0});var n=new FormData;n.append("imageUrl",e.target.files[0]),this.uploadService.uploadFile(n).then((function(e){t.setState({isUploading:!1,user:Object(h.a)(Object(h.a)({},t.state.user),{},{image:{url:e.data.secure_url,alt:t.state.user.username}})})})).catch((function(){return t.props.handleAlert(!0,"Error","Error uploading image")}))}},{key:"render",value:function(){var e=this;return Object(m.jsx)(j.a,{children:Object(m.jsx)(p.a,{children:Object(m.jsxs)(b.a,{md:{span:4,offset:4},children:[Object(m.jsx)("h1",{children:"Edit User"}),Object(m.jsx)("hr",{}),Object(m.jsxs)(R.a,{onSubmit:function(t){return e.handleSubmit(t)},children:[Object(m.jsxs)(R.a.Group,{children:[Object(m.jsx)(R.a.Label,{children:"Username"}),Object(m.jsx)(R.a.Control,{type:"text",name:"username",value:this.state.user.username,onChange:function(t){return e.handleInputChange(t)}})]}),Object(m.jsxs)(R.a.Group,{children:[Object(m.jsx)(R.a.Label,{children:"Password"}),Object(m.jsx)(R.a.Control,{type:"password",name:"password",value:this.state.user.password,onChange:function(t){return e.handleInputChange(t)}})]}),Object(m.jsxs)(R.a.Group,{children:[Object(m.jsxs)(R.a.Label,{children:["Image (File) ",this.state.isUploading&&Object(m.jsx)(N,{})]}),Object(m.jsx)(R.a.Control,{type:"file",name:"imageUrl",onChange:function(t){return e.handleFileUpload(t)}})]}),Object(m.jsx)(K.a,{variant:"dark",block:!0,type:"submit",children:"Submit"})]})]})})})}}]),n}(r.Component),ce=function(e){var t=e.storeUser,n=e.loggedUser,r=e.handleAlert,a=e.refreshUser;return Object(m.jsx)(m.Fragment,{children:Object(m.jsxs)(d.d,{children:[Object(m.jsx)(d.b,{path:"/",exact:!0,render:function(){return Object(m.jsx)(g,{})}}),Object(m.jsx)(d.b,{path:"/recipes",render:function(){return Object(m.jsx)(k,{handleAlert:r})}}),Object(m.jsx)(d.b,{path:"/recipe-details/:recipe_id",render:function(e){return Object(m.jsx)(z,Object(h.a)(Object(h.a)({},e),{},{loggedUser:n,handleAlert:r}))}}),Object(m.jsx)(d.b,{path:"/signup",render:function(e){return Object(m.jsx)(ae,Object(h.a)(Object(h.a)({storeUser:t},e),{},{handleAlert:r}))}}),Object(m.jsx)(d.b,{path:"/login",render:function(e){return Object(m.jsx)(se,Object(h.a)(Object(h.a)({storeUser:t},e),{},{handleAlert:r}))}}),void 0===n?Object(m.jsx)(N,{}):null===n?Object(m.jsx)(d.a,{to:"/"}):Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(d.b,{path:"/profile",render:function(e){return Object(m.jsx)(re,Object(h.a)(Object(h.a)({loggedUser:n,handleAlert:r},e),{},{refreshUser:a}))}}),Object(m.jsx)(d.b,{path:"/edit-user/:user_id",render:function(e){return Object(m.jsx)(ie,Object(h.a)(Object(h.a)({},e),{},{loggedUser:n,refreshUser:a}))}})]})]})})},le=n(125),oe=n(127),ue=(n(116),n.p+"static/media/logo_large.bf6a3bd5.png"),he=function(e){var t=e.storeUser,n=e.loggedUser,r=e.handleAlert,a=new ne;return Object(m.jsxs)(le.a,{expand:"lg",className:"navigation-bar",style:{marginBottom:30},children:[Object(m.jsx)(O.c,{to:"/",children:Object(m.jsxs)(le.a.Brand,{children:[" ",Object(m.jsx)("img",{alt:"",src:ue,className:"d-inline-block align-top logo-nav"})," "]})}),Object(m.jsx)(le.a.Toggle,{"aria-controls":"basic-navbar-nav"}),Object(m.jsx)(le.a.Collapse,{id:"responsive-navbar-nav",children:Object(m.jsxs)(oe.a,{className:"ml-auto nav-rightside",children:[Object(m.jsx)(O.c,{style:{textDecoration:"none"},to:"/recipes",children:Object(m.jsx)(oe.a.Link,{className:"navbar-link",as:"span",children:"Recipes list"})}),n?Object(m.jsxs)(m.Fragment,{children:[Object(m.jsxs)(O.c,{style:{textDecoration:"none"},className:"user-nav",to:"/profile",children:[Object(m.jsx)("img",{className:"nav-img",src:n.image.url,alt:n.image.alt}),Object(m.jsx)(oe.a.Link,{href:"/profile",as:"span",className:"navbar-link",children:n.username})]}),Object(m.jsx)(oe.a.Link,{className:"navbar-link",onClick:function(){a.logOut().then((function(){t(null)})).catch((function(){return r(!0,"Error","Failed to logout user")}))},children:"Logout"})]}):Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(O.c,{style:{textDecoration:"none"},to:"/login",children:Object(m.jsx)(oe.a.Link,{className:"navbar-link",as:"span",children:"Login"})}),Object(m.jsx)(O.c,{style:{textDecoration:"none"},to:"/signup",children:Object(m.jsx)(oe.a.Link,{as:"span",className:"navbar-link",children:"Signup"})})]})]})})]})},de=(n(117),function(){return Object(m.jsx)("footer",{children:Object(m.jsxs)("small",{children:["Todos los derechos reservados ",(new Date).getFullYear()]})})}),je=n(126),pe=n.p+"static/media/logo_small_icon_only_inverted.16291f80.png",be=function(e){var t=e.handleAlert,n=e.show,r=e.title,a=void 0===r?"System message":r,s=e.text;return Object(m.jsxs)(je.a,{autohide:!0,show:n,onClose:function(){return t(!1)},delay:3e3,style:{zIndex:9999,position:"fixed",color:"white",bottom:38,right:17,width:400,backgroundColor:"#008650"},children:[Object(m.jsxs)(je.a.Header,{children:[Object(m.jsx)("img",{src:pe,className:"rounded mr-2",alt:"Logotipo",style:{width:20,height:20}}),Object(m.jsx)("strong",{className:"mr-auto",children:a})]}),Object(m.jsx)(je.a.Body,{children:s})]})},Oe=function(e){Object(o.a)(n,e);var t=Object(u.a)(n);function n(){var e;return Object(c.a)(this,n),(e=t.call(this)).handleAlert=function(t,n,r){return e.setState({alert:{show:t,title:n,text:r}})},e.state={loggedUser:void 0,alert:{show:!1,title:"",text:""}},e.authService=new ne,e}return Object(l.a)(n,[{key:"storeUser",value:function(e){this.setState({loggedUser:e})}},{key:"fetchUser",value:function(){var e=this;this.authService.isLoggedIn().then((function(t){e.storeUser(t.data)})).catch((function(){return e.storeUser(null)}))}},{key:"componentDidMount",value:function(){this.fetchUser()}},{key:"render",value:function(){var e=this;return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(he,{handleAlert:this.handleAlert,storeUser:function(t){return e.storeUser(t)},loggedUser:this.state.loggedUser,refreshUser:function(){return e.fetchUser()}}),Object(m.jsx)("main",{children:Object(m.jsx)(ce,{storeUser:function(t){return e.storeUser(t)},loggedUser:this.state.loggedUser,handleAlert:this.handleAlert,refreshUser:function(){return e.fetchUser()}})}),Object(m.jsx)(de,{}),Object(m.jsx)(be,{handleAlert:this.handleAlert,show:this.state.alert.show,title:this.state.alert.title,text:this.state.alert.text})]})}}]),n}(r.Component);i.a.render(Object(m.jsx)(a.a.StrictMode,{children:Object(m.jsx)(O.a,{children:Object(m.jsx)(Oe,{})})}),document.getElementById("root"))},74:function(e,t,n){},75:function(e,t,n){}},[[118,1,2]]]);
//# sourceMappingURL=main.d8c11bbc.chunk.js.map